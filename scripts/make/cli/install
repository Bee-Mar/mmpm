#!/bin/bash
source ./scripts/make/constants

printf "[+] \e[92mInstalling MMPM CLI \e[0m\n"

log_action "Installing MMPM CLI"

printf " -- creating directories and files"
log_and_eval "mkdir -vp ~/.config/mmpm/log"
log_and_eval "touch ~/.config/mmpm/log/{mmpm-gunicorn-{error,access}.log,mmpm-cli-interface.log}"
_done_

printf " -- installing CLI using 'pip3 install --user' (this may take a while)"
log_and_eval "pip3 install --user ."
_done_

printf " -- initializing MMPM/MagicMirror database"
log_and_eval "$HOME/.local/bin/mmpm db --refresh"
_done_

printf " -- migrating legacy keys and external modules"
log_and_eval "$HOME/.local/bin/mmpm --migrate"

log_action "MMPM CLI Installed"

printf "[+] \033[1;36mMMPM CLI Installed \e[0m\n"
printf "[+] \e[92mNOTE: Ensure \"${HOME}/.local/bin\" is in your PATH\e[0m\n"


